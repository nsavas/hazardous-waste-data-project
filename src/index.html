<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.css' rel='stylesheet' />

    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v3.1.0/mapbox-gl-geocoder.min.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v3.1.0/mapbox-gl-geocoder.css' type='text/css' />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="index.css">

    <title>ACM PROJECT</title>
</head>

<body>
    <div id="map" style="height: 100vh;"></div>
    <div id="header">
        <div id="header-bg">
            <h1>US Chemical Release Visualizer</h1>
            <div id="header-inner-bg">
                <h2>
                    Welcome to the <strong>US Chemical Release Visualizer</strong><br/>
                    Generate a visualization of this past decades chemical release data within
                    a US City using data from the <a href="http://www.epa.gov">EPA</a>. 
                </h2>
                <div id="dropdown">
                    <input type="text" name="search" id="search" placeholder="Enter a city..."/>
                </div>
                <ul class="list-group" id="result"></ul>
                </ul>
                <br />
            </div>
        </div>
    </div>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="app.js"></script>
    <script>
        $(document).ready(function() {
            $('#search').keyup(function() {
                $('#result').html('');
                let searchField = $('#search').val().toUpperCase();
                //let expression = new RegExp(searchField, 'i');
                $.getJSON('../data/csvjson.json', function(data) {
                    $.each(data, function(key, value) {
                        if (value.city.toUpperCase().startsWith(searchField) && $('ul#result li').length < 5 && searchField.length > 0) {
                            $('#result').append('<li class="list-group-item">' + value.city + ', ' + value.state_id + '</li>')
                        }

                    })
                })
            })
            $('#result').keydown(function() {
                $('.list-group').remove();
            });
        })
    </script>

    <script language="javascript">
        function dropdownMenu() {
            var input, filter, x;
            input = document.getElementById("myInput");
            filter = input.value.toUpperCase();
            div = document.getElementById("dropdown");
            // x = div.getElementsByTagName("x");
            for (i = 0; i < x.length; i++) {
                textValue = x[i].textContent || x[i].innerText;
                if (textValue.toUpperCase().indexOf(filter) > -1) {
                    x[i].style.display = "";
                }
                else {
                    x[i].style.display = "none";
                }
            }
        }
    </script>
</body>
</html>